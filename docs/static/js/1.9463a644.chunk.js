(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[1],{27:function(t,e,i){"use strict";i.r(e);var n,s=i(17),a=i(0),o=i.n(a),r=i(10),l=i(73),c=i(20),u=i(19),d=i(21),f=i(74),h=i(75);!function(t){t[t.EMPTY=0]="EMPTY",t[t.HALF=1]="HALF",t[t.DONE=2]="DONE"}(n||(n={}));var v=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(u.a)(e).call(this,{direction:"y"}))).Refresh_Distance=void 0,t.distanceStatus=void 0,t.isRefreshable=void 0,t.beginTime=void 0,t.matLimit=void 0,t.Refresh_Distance=90,t.isRefreshable=!0,t.matLimit=.7,t}return Object(d.a)(e,t),Object(l.a)(e,[{key:"_getFinalEndPonit",value:function(){return{x:0,y:0}}},{key:"_resetSomething",value:function(){this._markBeginTime(),this.distance[this.direction]=0}},{key:"_markBeginTime",value:function(){this.beginTime=Date.now()}},{key:"_getTimeTotal",value:function(){return Date.now()-this.beginTime}},{key:"getExpectMat",value:function(){var t=this.getMoveDist()/this._getTimeTotal();return t<this.matLimit&&t>-this.matLimit?0:456*t}},{key:"setRefreshAble",value:function(t){this.isRefreshable=t}},{key:"resetRefreshStatus",value:function(){this.distanceStatus=n.EMPTY}},{key:"markScrollTip",value:function(){var t="",e=this.getMoveDist();return e>this.Refresh_Distance?(this.distanceStatus=n.DONE,t="\u677e\u5f00\u5237\u65b0"):e>0&&(this.distanceStatus=n.HALF,t="\u4e0b\u62c9\u5237\u65b0"),t}},{key:"getUpdateStatus",value:function(){return this.distanceStatus===n.DONE?"update":this.distanceStatus===n.HALF?"reset":"none"}}]),e}(h.a);function m(t){var e=t.className,i=void 0===e?"":e;return o.a.createElement("div",{className:"zui-marble-loading ".concat(i)},o.a.createElement("div",{className:"zui-marble"}),o.a.createElement("div",{className:"zui-marble"}),o.a.createElement("div",{className:"zui-marble"}))}var p=function(t){function e(t){var i;return Object(r.a)(this,e),(i=Object(c.a)(this,Object(u.a)(e).call(this,t))).freshBoxClassName=void 0,i.refScrollWarp=void 0,i.refScrollBody=void 0,i.eventControl=void 0,i.scrollControl=void 0,i.freshStore=void 0,i.Begin_Distance=void 0,i.End_Distance=void 0,i.oldDistance=void 0,i.scrollBottleneck=void 0,i.hideScrollTip=function(){i.setState({transform:{distance:i.Begin_Distance,time:.5}})},i.updateScroll=function(){i.props.freshHandler(),i.setState({scrollTip:"\u5237\u65b0\u5b8c\u6210>>>",transform:{distance:0,time:2}}),setTimeout((function(){i.hideScrollTip()}),300)},i.loadAnm=function(){i.state.isLoading||(i.setState({isLoading:!0}),setTimeout((function(){i.setState({isLoading:!1})}),500))},i.getScrollBottleneck=function(){return i.refScrollBody.offsetHeight-i.refScrollWarp.offsetHeight+i.Begin_Distance},i.scrollMat=function(){var t=i.scrollControl.getExpectMat();if(t){var e=i.state.transform.distance+t;e>i.Begin_Distance?e=i.Begin_Distance:e<-i.scrollBottleneck&&(e=-i.scrollBottleneck),i.setState({transform:{distance:e,time:.5}})}},i.onStartHandler=function(t){i.setState({transform:{distance:i.state.transform.distance,time:0}}),i.scrollControl.start(t);var e=i.state.transform.distance===i.Begin_Distance;i.scrollControl.setRefreshAble(e),i.oldDistance=i.state.transform.distance,i.scrollBottleneck=i.getScrollBottleneck()},i.onMoveHandler=function(t){t.preventDefault();var e=i.scrollControl.move(t).y;if(e>0&&i.scrollControl.isRefreshable){var n=i.scrollControl.markScrollTip();i.setState({scrollTip:n})}var s,a=i.oldDistance+e;s=!i.scrollControl.isRefreshable&&a>i.Begin_Distance?i.Begin_Distance:i.scrollBottleneck<=-a?-i.scrollBottleneck-i.End_Distance:e>0?i.oldDistance+e/2:a,i.setState({transform:{distance:s,time:0}})},i.onEndHandler=function(){if(i.scrollControl.end(),"function"===typeof i.props.freshHandler){var t=i.scrollControl.getUpdateStatus();if("none"!==t)return i.freshStore[t](),void i.scrollControl.resetRefreshStatus()}i.scrollMat(),"function"===typeof i.props.loadHandler&&i.scrollBottleneck<=-i.state.transform.distance&&(i.props.loadHandler(),i.loadAnm())},i.freshBoxClassName="zui-scroll-box ".concat(t.className||""),i.Begin_Distance=-50,i.End_Distance=26,i.scrollControl=new v,i.freshStore={update:i.updateScroll,reset:i.hideScrollTip,none:function(){}},i.oldDistance=0,i.scrollBottleneck=0,i.state={transform:{distance:i.Begin_Distance,time:0},scrollTip:"",isLoading:!1},i}return Object(d.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.eventControl=new f.a(this.refScrollWarp),this.eventControl.createEventList(this.onStartHandler,this.onMoveHandler,this.onEndHandler),this.eventControl.listenerAllOfEle()}},{key:"componentWillUnmount",value:function(){this.eventControl.removeAllOfEle()}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:this.freshBoxClassName,ref:function(e){return t.refScrollWarp=e}},o.a.createElement("div",{className:"zui-scroll-area",ref:function(e){return t.refScrollBody=e},style:{transform:"translate(0, ".concat(this.state.transform.distance,"px)"),transition:"transform ".concat(this.state.transform.time,"s ease-out")}},o.a.createElement("div",{className:"zui-scroll-tip"},this.state.scrollTip),o.a.createElement("div",{className:"zui-scroll"},this.props.children)),this.state.isLoading?o.a.createElement(m,{className:"zui-load-tip"}):null)}}]),e}(o.a.PureComponent);function D(t){return Array(t.num).fill(0).map((function(t,e){return o.a.createElement("div",{className:"test-content",key:e},e+1,"\uff1a\u9700\u7528\u624b\u673a\u6a21\u5f0f\u6d4b\u8bd5")}))}e.default=function(){var t=Object(a.useState)(50),e=Object(s.a)(t,2),i=e[0],n=e[1];return o.a.createElement(p,{className:"test-fresh",freshHandler:function(){console.log("\u5237\u65b0"),n(50)},loadHandler:function(){console.log("\u52a0\u8f7d"),n(i+30)}},o.a.createElement(D,{num:i}))}},73:function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}i.d(e,"a",(function(){return s}))},74:function(t,e,i){"use strict";var n=i(10),s=i(73),a=i(6),o=function(){function t(e){Object(n.a)(this,t),this.eventList=void 0,this.willPreventDefault=void 0,this.willNotPreventDefault=void 0,this.$ele=void 0,this.eventList={};var i=Object(a.e)();this.willPreventDefault=!!i&&{passive:!1,capture:!1},this.willNotPreventDefault=!!i&&{passive:!0},this.$ele=e}return Object(s.a)(t,[{key:"createEventList",value:function(t,e,i){"ontouchstart"in window?this.eventList={touchstart:t,touchmove:e,touchend:i}:this.eventList={mousedown:t,mousemove:e,mouseup:i}}},{key:"listenerAllOfEle",value:function(){var t=this;Object.keys(this.eventList).forEach((function(e){var i=e.indexOf("move")>=0?t.willPreventDefault:t.willNotPreventDefault;t.$ele.addEventListener(e,t.eventList[e],i)}))}},{key:"removeAllOfEle",value:function(){var t=this;Object.keys(this.eventList).forEach((function(e){t.$ele.removeEventListener(e,t.eventList[e])}))}}]),t}();e.a=o},75:function(t,e,i){"use strict";var n=i(18),s=i(10),a=i(73),o=i(6),r=JSON.stringify({x:0,y:0}),l=function(){function t(e){var i=e.direction,n=void 0===i?"x":i;Object(s.a)(this,t),this.startPoint=void 0,this.distance=void 0,this.endPoint=void 0,this.direction=void 0,this.Prevent_Distance=void 0,this.lockDirection=void 0,this.isAnm=void 0,this.direction=n,this.startPoint=JSON.parse(r),this.distance=JSON.parse(r),this.endPoint=JSON.parse(r),this.Prevent_Distance=5,this.lockDirection=null,this.isAnm=!1}return Object(a.a)(t,[{key:"_getFinalEndPonit",value:function(){throw Error("_getFinalEndPonit \u9700\u8981\u88ab\u91cd\u5199")}},{key:"_resetSomething",value:function(){this.distance[this.direction]=0}},{key:"_getLockDirection",value:function(){var t=Math.abs(this.distance.x),e=Math.abs(this.distance.y),i=null;return"x"===this.direction?t>=e&&t>this.Prevent_Distance?i="x":e>this.Prevent_Distance&&(i="y"):e>=t&&e>this.Prevent_Distance?i="y":t>this.Prevent_Distance&&(i="x"),i}},{key:"getMoveDist",value:function(){return this.endPoint[this.direction]-this.distance[this.direction]}},{key:"start",value:function(t){this.isAnm=!0;var e=Object(o.b)(t);this.lockDirection=null,this.startPoint={x:e.pageX,y:e.pageY},this._resetSomething()}},{key:"move",value:function(t){if(this.isAnm){var e=Object(o.b)(t);if(this.distance={x:this.startPoint.x-e.pageX,y:this.startPoint.y-e.pageY},this.lockDirection){if(this.direction===this.lockDirection)return t.preventDefault&&t.preventDefault(),Object.assign({x:0,y:0},Object(n.a)({},this.direction,this.getMoveDist()))}else this.lockDirection=this._getLockDirection(),"y"===this.direction&&t.preventDefault&&t.preventDefault()}return this.endPoint}},{key:"end",value:function(){return this.isAnm=!1,this._getFinalEndPonit()}}]),t}();e.a=l}}]);
//# sourceMappingURL=1.9463a644.chunk.js.map